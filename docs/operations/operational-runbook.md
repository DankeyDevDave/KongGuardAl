# Kong Guard AI + Claude-Flow v2.0.0 Alpha Operational Runbook

## Production Deployment Guide

### **Prerequisites**
- Docker and Docker Compose installed
- Node.js 18+ for Claude-Flow
- Proxmox environment with self-hosted GitHub runner
- Required API keys configured in environment

### **Quick Start**
```bash
# 1. Deploy via GitHub Actions (automatic)
git push origin main # Triggers Proxmox deployment

# 2. Manual deployment (if needed)
npx claude-flow@alpha init --force --hive-mind
docker-compose up -d --build
./scripts/validate-all.sh
```

## Claude-Flow v2.0.0 Alpha Operations

### **Neural Threat Prediction Management**
```bash
# Check neural model status
npx claude-flow@alpha neural status

# Train new threat patterns
npx claude-flow@alpha neural train --pattern prediction \
  --training-data "new-threat-patterns.json" --epochs 25

# Get threat predictions
npx claude-flow@alpha neural predict --model "threat-model" \
  --input "suspicious-traffic-data"
```

### **Dynamic Agent Management**
```bash
# Check swarm status
npx claude-flow@alpha swarm status

# Spawn security agents for high threats
npx claude-flow@alpha agent spawn --type security \
  --name "Emergency Response Team"

# Scale agents based on load
npx claude-flow@alpha swarm scale --target-size 10
```

### **Memory and Context Management**
```bash
# Store operational context
npx claude-flow@alpha memory store "incident-response" \
  "Details of security incident and resolution" \
  --namespace kong-security

# Query threat intelligence
npx claude-flow@alpha memory query "attack-patterns" \
  --namespace kong-security --recent

# Export memory for backup
npx claude-flow@alpha memory export security-backup.json
```

## Security Operations

### **Threat Detection Monitoring**
```bash
# Check Kong Guard AI status
curl http://localhost:8001/_guard_ai/status

# View real-time threat metrics
curl http://localhost:8001/_guard_ai/metrics

# Monitor neural predictions
npx claude-flow@alpha monitoring system-health
```

### **Incident Response Procedures**

#### **High Threat Detection**
1. **Automatic Response**: Claude-Flow spawns security agents
2. **Manual Escalation**: 
   ```bash
   npx claude-flow@alpha swarm "Emergency security response for threat ID: XXXXX"
   ```
3. **Incident Documentation**:
   ```bash
   npx claude-flow@alpha memory store "incident-$(date +%s)" \
     "Threat details and response actions" --namespace incidents
   ```

#### **Performance Degradation**
1. **Auto-scaling**: Agents automatically spawn at 70% threshold
2. **Manual Optimization**:
   ```bash
   npx claude-flow@alpha bottleneck analyze --auto-optimize
   npx claude-flow@alpha topology optimize
   ```

## Monitoring and Alerting

### **Key Metrics to Monitor**
- **Kong Gateway**: Response time, error rates, throughput
- **Claude-Flow**: Agent count, neural model accuracy, memory usage
- **Security**: Threat detection rates, false positives, blocked requests

### **Dashboard Endpoints**
- **Kong Status**: `http://localhost:8001/status`
- **Guard AI Metrics**: `http://localhost:8001/_guard_ai/metrics`
- **Performance Dashboard**: Generated by Claude-Flow agents

### **Alert Thresholds**
- **High Threat**: >80% confidence score
- **Performance**: >10ms latency or >70% resource usage
- **Neural Model**: <60% accuracy requires retraining

## Maintenance Procedures

### **Daily Operations**
```bash
# Morning health check
npx claude-flow@alpha health check --auto-heal

# Update threat intelligence
npx claude-flow@alpha memory sync --source external-feeds

# Performance review
npx claude-flow@alpha analysis performance-report
```

### **Weekly Maintenance**
```bash
# Retrain neural models
npx claude-flow@alpha neural train --pattern coordination --epochs 50

# Backup configurations
npx claude-flow@alpha memory backup --namespace kong-security

# Security audit
npx claude-flow@alpha security scan --comprehensive
```

### **Monthly Reviews**
- Review neural model accuracy and retrain if needed
- Analyze incident patterns and update response procedures
- Update threat intelligence feeds and patterns
- Performance optimization based on usage patterns

## Emergency Procedures

### **System Failure Recovery**
```bash
# Quick recovery
docker-compose down && docker-compose up -d --build

# Full reset with Claude-Flow
npx claude-flow@alpha init --rollback --last-known-good
npx claude-flow@alpha memory restore backup.json
```

### **Security Breach Response**
```bash
# Emergency lockdown
npx claude-flow@alpha security lockdown --immediate

# Forensic analysis
npx claude-flow@alpha swarm "Forensic analysis of security breach" \
  --agents security,analyst --priority critical

# Recovery planning
npx claude-flow@alpha memory store "breach-response" \
  "Timeline and actions taken" --namespace incidents
```

## Troubleshooting

### **Common Issues**

#### **Neural Model Poor Performance**
```bash
# Check model health
npx claude-flow@alpha neural status

# Retrain with more data
npx claude-flow@alpha neural train --pattern prediction \
  --training-data "enhanced-dataset.json" --epochs 100
```

#### **Agent Coordination Issues**
```bash
# Reset swarm
npx claude-flow@alpha swarm destroy
npx claude-flow@alpha swarm init --topology hierarchical

# Check memory consistency
npx claude-flow@alpha memory validate --namespace kong-security
```

#### **Kong Plugin Issues**
```bash
# Validate plugin
./scripts/validate-plugin-lifecycle.sh

# Check Kong logs
docker logs $(docker ps --filter name=kong --format '{{.ID}}')

# Restart Kong with validation
docker-compose restart kong
```

## Support Contacts

- **Primary On-Call**: Security Operations Team
- **Claude-Flow Support**: GitHub Issues (ruvnet/claude-flow)
- **Kong Support**: Kong Enterprise Support Portal
- **Emergency Escalation**: DevOps Team Lead

## Change Management

### **Deployment Process**
1. **Development**: Test in local environment with Claude-Flow
2. **Staging**: Deploy to staging Proxmox environment
3. **Production**: Automated deployment via GitHub Actions
4. **Monitoring**: 24-hour monitoring post-deployment

### **Configuration Changes**
- All changes must be tested with Claude-Flow simulation
- Neural models retrained with new configurations
- Memory backup before applying changes
- Rollback plan documented and tested

---

** Powered by Claude-Flow v2.0.0 Alpha + Kong Guard AI Enterprise Security**