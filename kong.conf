# Kong Configuration for Development
# This file configures Kong Gateway for local development with the kong-guard-ai plugin

# Database settings
database = postgres
pg_host = kong-database
pg_port = 5432
pg_user = kong
pg_password = kongpass
pg_database = kong

# Network settings
proxy_listen = 0.0.0.0:8000, 0.0.0.0:8443 ssl
admin_listen = 0.0.0.0:8001, 0.0.0.0:8444 ssl

# Plugin settings
plugins = bundled,kong-guard-ai
lua_package_path = /usr/local/share/lua/5.1/kong/plugins/custom/?.lua;;

# Logging
log_level = debug
proxy_access_log = /dev/stdout
admin_access_log = /dev/stdout
proxy_error_log = /dev/stderr
admin_error_log = /dev/stderr

# Development settings
nginx_worker_processes = auto
nginx_daemon = off

# Security settings for development
trusted_ips = 0.0.0.0/0
real_ip_header = X-Real-IP
real_ip_recursive = off

# Headers
headers = server_tokens=off

# Memory settings
mem_cache_size = 128m

# SSL settings for development (disable SSL verification for testing)
ssl_verify_depth = 1
client_ssl = off
client_ssl_cert_default = /etc/ssl/certs/kong-default.crt
client_ssl_cert_key_default = /etc/ssl/private/kong-default.key

# Admin API settings
admin_api_uri = http://kong:8001

# Custom settings for the kong-guard-ai plugin
# These can be overridden via Admin API or declarative config
kong_guard_ai_enabled = on
kong_guard_ai_dry_run = off
kong_guard_ai_log_level = debug
kong_guard_ai_redis_host = redis
kong_guard_ai_redis_port = 6379